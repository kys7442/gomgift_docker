; PHP-FPM Pool 설정 (성능 최적화)
[www]
user = www-data
group = www-data

; 프로세스 관리 방식
; static: 고정된 수의 프로세스 유지 (성능 최적)
; dynamic: 요청에 따라 프로세스 수 조절
; ondemand: 요청 시에만 프로세스 생성 (메모리 절약)
pm = dynamic

; 최대 프로세스 수 (동적 모드)
pm.max_children = 50

; 시작 시 프로세스 수
pm.start_servers = 10

; 유휴 상태 최소 프로세스 수
pm.min_spare_servers = 5

; 유휴 상태 최대 프로세스 수
pm.max_spare_servers = 20

; 프로세스 재시작 간격 (초)
pm.process_idle_timeout = 10s

; 요청 처리 후 프로세스 종료 대기 시간 (ondemand 모드)
pm.max_requests = 500

; 상태 페이지 활성화
pm.status_path = /status

; 핑 페이지 활성화
ping.path = /ping

; 로그 설정
access.log = /proc/self/fd/2
access.format = "%R - %u %t \"%m %r%Q%q\" %s %f %{mili}d %{kilo}M %C%%"

; 에러 로그
php_admin_value[error_log] = /proc/self/fd/2
php_admin_flag[log_errors] = on

; 환경 변수
clear_env = no

; 보안 설정
security.limit_extensions = .php

; 요청 타임아웃
request_terminate_timeout = 3000s

; 요청 슬로우 로그 (10초 이상 걸리는 요청 기록)
slowlog = /proc/self/fd/2
request_slowlog_timeout = 10s

